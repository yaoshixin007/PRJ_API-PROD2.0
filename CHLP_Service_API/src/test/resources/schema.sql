DROP schema IF EXISTS dbo ;
create schema dbo AUTHORIZATION DBA;
SET DATABASE SQL SYNTAX MSS true;
CREATE TABLE dbo.MTRL_DIM_CN (
	MTRL_DIM_CN_KEY	 	 INTEGER NOT NULL PRIMARY KEY generated by default as identity (start with 1),
	MTRL_PLM_NBR         BIGINT NULL ,
	MTRL_DESC_EN         VARCHAR(60) NULL ,
	INSRT_TSTMP          TIMESTAMP NULL ,
	EXP_TSTMP            DATETIME NULL ,
	MTRL_QAD_NBR         BIGINT NULL ,
	MTRL_DESC_CN         NVARCHAR(100) NULL ,
	MTRL_CMRL_NBR        BIGINT NULL ,
	MTRL_PCK_SIZE        BIGINT NULL ,
	MINM_ORD_QTY         INT NULL ,
	PRD_ACTIVE_DATE      DATETIME NULL ,
	PRD_EXP_DATE         DATETIME NULL ,
	PLM_QAD_SYNC_DATE    DATETIME NULL ,
	PRD_STAT_QAD         VARCHAR(20) NULL ,
	PRD_STAT_PLM         INT NULL ,
	PRD_STAT_DESC_PLM    VARCHAR(50) NULL ,
	PRD_LN_DESC_CN       NVARCHAR(50) NULL ,
	PRD_LN_CDE_CN        NVARCHAR(20) NULL ,
	PRD_BRND_CDE_CN      NVARCHAR(20) NULL ,
	PRD_BRND_DESC_CN     NVARCHAR(50) NULL ,
	GRP_SIZE_CDE_CN      NVARCHAR(20) NULL ,
	GRP_SIZE_DESC_CN     NVARCHAR(50) NULL ,
	LAST_MDFD_DATE_QAD   DATETIME NULL );
	
	CREATE TABLE dbo.MTRL_SN_DIM (
	MTRL_SN_DIM_KEY       INTEGER NOT NULL PRIMARY KEY generated by default as identity (start with 1),
	MTRL_DIM_CN_KEY 		int NOT NULL,
	LAST_BATT_OPRTN_TYP_DIM_KEY int NULL,
	PRD_SRL_NBR 			VARCHAR(20) NULL,
	PKG_SRL_NBR VARCHAR(20) NULL,
	MTRL_QAD_NBR bigint NULL,
	LAST_OPRTN_CHL VARCHAR(20) NULL,
	LAST_OPRTN_TSTMP DATETIME NULL,
	LAST_OPRTN_ORGN VARCHAR(100) NULL,
	LAST_OPRTN_DEST VARCHAR(100) NULL,
	LAST_OPRTR VARCHAR(100) NULL,
	LAST_OPRTR_SYS VARCHAR(20) NULL,
	LAST_OPRTR_RMKS VARCHAR(100) NULL,
	LAST_RFRNC_ORD_NBR VARCHAR(100) NULL,
	LAST_RFRNC_ORD_TYP VARCHAR(100) NULL,
	INSRT_TSTMP DATETIME NULL,
	EXP_TSTMP DATETIME NULL);

ALTER TABLE dbo.MTRL_SN_DIM ADD FOREIGN KEY (MTRL_DIM_CN_KEY) REFERENCES dbo.MTRL_DIM_CN (MTRL_DIM_CN_KEY);

CREATE TABLE dbo.BUS_PRTNR_DIM_CN(
	BUS_PRTNR_DIM_CN_KEY 	INTEGER NOT NULL PRIMARY KEY generated by default as identity (start with 1),
	MDG_CUST_KEY 			VARCHAR(20) NULL,
	BUS_PRTNR_CDE 			VARCHAR(20) NULL,
	BUS_PRTNR_NM 			VARCHAR(100) NULL,
	BUS_PRTNR_TYP 			VARCHAR(20) NULL,
	BUS_PRTNR_TYP_DESC 		VARCHAR(50) NULL,
	BUS_PRTNR_CNTRY_CDE 	VARCHAR(20) NULL,
	MINM_ORD_QTY 			int NULL,
	BUS_PRTNR_STAT 			VARCHAR(20) NULL,
	MDG_OPRTN_TSTMP 		DATETIME NULL,
	INSRT_TSTMP 			DATETIME NULL,
	EXP_TSTMP 				DATETIME NULL
);

	
CREATE TABLE dbo.BATT_OPRTN_TYP_DIM
(
	BATT_OPRTN_TYP_DIM_KEY 		INTEGER NOT NULL PRIMARY KEY generated by default as identity (start with 1),
	OPRTN_TYP_CDE 				VARCHAR(10) NULL,
	OPRTN_TYP_DESC 				VARCHAR(100) NULL,
	OPRTR_NM 					VARCHAR(100) NULL,
	OPRTN_ORGN 					VARCHAR(100) NULL,
	OPRTN_DEST 					VARCHAR(100) NULL,
	INSRT_TSTMP 				DATETIME NULL,
	EXP_TSTMP 					DATETIME NULL
);

CREATE TABLE dbo.BATT_OPRTN
(
	BATT_OPRTN_KEY 			INTEGER NOT NULL PRIMARY KEY generated by default as identity (start with 1),
	BATT_OPRTN_TYP_DIM_KEY 	INT NOT NULL,
	MESSAGE_ID 				VARCHAR(80) NULL,
	OPRTN_CHL 				VARCHAR(20) NULL,
	PRD_SRL_NBR 			VARCHAR(20) NULL,
	OPRTN_TSTMP 			DATETIME NULL,
	OPRTN_ORGN 				VARCHAR(100) NULL,
	OPRTN_DEST 				VARCHAR(100) NULL,
	OPRTR					VARCHAR(100) NULL,
	OPRTR_SYS 				VARCHAR(20) NULL,
	OPRTR_RMKS 				VARCHAR(100) NULL,
	RFRNC_ORD_NBR 			VARCHAR(100) NULL,
	RFRNC_ORD_TYP 			VARCHAR(100) NULL,
	INSRT_TSTMP 			DATETIME NULL,
	EXP_TSTMP 				DATETIME NULL
);

CREATE TABLE dbo.PRD_CMRL_DTLS
(
	PRD_CMRL_KEY		INTEGER NOT NULL PRIMARY KEY generated by default as identity (start with 1),
	MTRL_CMRL_NBR		BIGINT NULL,
	MTRL_CMRL_NBR_DESC	VARCHAR(30) NULL,
	PRD_STD_DESC VARCHAR(30) NULL,
	PRD_ALIAS_DESC VARCHAR(30) NULL,
	MTRL_DESC_CN VARCHAR(40) NULL,
	MTRL_DESC_EN VARCHAR(40) NULL,
	GRP_SIZE_DESC_CN VARCHAR(30) NULL,
	GRP_SIZE_CDE_CN VARCHAR(30) NULL,
	MTRL_UNIT_CDE VARCHAR(3) NULL,
	MTRL_UNIT_CDE_DESC VARCHAR(10) NULL,
	PRD_TYP_DESC_CN VARCHAR(30) NULL,
	PRD_TYP_CDE_CN VARCHAR(30) NULL,
	PRD_BRND_DESC_CN VARCHAR(30) NULL,
	PRD_BRND_CDE_CN VARCHAR(30) NULL,
	PRD_STAT_PLM VARCHAR(2) NULL,
	PRD_STAT_DESC_PLM VARCHAR(25) NULL,
	GR_WT decimal(13, 3) NULL,
	NET_WT decimal(13, 3) NULL,
	WT_UNIT_CDE VARCHAR(3) NULL,
	WT_UNIT_DESC VARCHAR(10) NULL,
	MTRL_LEN VARCHAR(30) NULL,
	MTRL_WID VARCHAR(30) NULL,
	MTRL_HEI VARCHAR(30) NULL,
	PRD_LN_DESC_CN VARCHAR(30) NULL,
	PRD_LN_CDE_CN VARCHAR(30) NULL,
	PRD_CUST_AH decimal(16, 3) NULL,
	PRD_CUST_CCA VARCHAR(30) NULL,
	INSRT_TSTMP			DATETIME NULL,
	EXP_TSTMP			DATETIME NULL
	);

ALTER TABLE dbo.BATT_OPRTN ADD FOREIGN KEY (BATT_OPRTN_TYP_DIM_KEY) REFERENCES dbo.BATT_OPRTN_TYP_DIM (BATT_OPRTN_TYP_DIM_KEY);